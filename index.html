DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arcade Demon Top Oyunu</title>
<style>
body { margin: 0; overflow: hidden; background: #0d0d0d; }
canvas { display: block; margin: 0 auto; touch-action: none; }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let WIDTH = window.innerWidth;
let HEIGHT = window.innerHeight;
canvas.width = WIDTH;
canvas.height = HEIGHT;

// Top
let ballRadius = Math.min(WIDTH, HEIGHT) * 0.03;
let ballX = WIDTH/2;
let ballY = HEIGHT/2;
let ballSpeedX = Math.max(12, WIDTH*0.01);
let ballSpeedY = Math.max(12, HEIGHT*0.01);

// Raketler
let paddleWidth = Math.min(WIDTH, HEIGHT)*0.03;
let paddleHeight = Math.min(WIDTH, HEIGHT)*0.25;
let paddleSpeed = Math.max(20, HEIGHT*0.02);
let leftPaddleY = HEIGHT/2 - paddleHeight/2;
let rightPaddleY = HEIGHT/2 - paddleHeight/2;

// Skor
let leftScore = 0;
let rightScore = 0;

// Bot ayarları
let botSpeed = 6;
let botError = 0.3;

// Rainbow renk yavaş
let colorOffset = 0;
function rainbowColorSlow(offset=0){
    if(leftScore>=160){ // Demon modu alev renkleri
        let t = colorOffset + offset;
        let r = Math.floor(200 + 55*Math.sin(t));
        let g = Math.floor(50 + 50*Math.sin(t/2));
        let b = 0;
        return `rgb(${r},${g},${b})`;
    }
    let t = colorOffset + offset;
    let r = Math.floor((Math.sin(t)+1)*127);
    let g = Math.floor((Math.sin(t+2)+1)*127);
    let b = Math.floor((Math.sin(t+4)+1)*127);
    return `rgb(${r},${g},${b})`;
}

// Patlama efektleri
let hitFlash = 0;
let trails = [];
let fireParticles = [];
let screenShake = 0;

// Dokunmatik kontrol
canvas.addEventListener('touchstart', e=>{ e.preventDefault(); for(let t of e.touches) if(t.clientX<WIDTH/2) leftPaddleY=t.clientY-paddleHeight/2; }, {passive:false});
canvas.addEventListener('touchmove', e=>{ e.preventDefault(); for(let t of e.touches) if(t.clientX<WIDTH/2) leftPaddleY=t.clientY-paddleHeight/2; }, {passive:false});

// Klavye kontrol
let keys = {};
window.addEventListener('keydown', e=>keys[e.key]=true);
window.addEventListener('keyup', e=>keys[e.key]=false);

// Arka plan
function drawBackground() {
    if(leftScore>=160){ // Demon modu arka plan
        let gradient = ctx.createLinearGradient(0,0,WIDTH,HEIGHT);
        gradient.addColorStop(0,'#ff4500');
        gradient.addColorStop(0.5,'#8b0000');
        gradient.addColorStop(1,'#ff8c00');
        ctx.fillStyle = gradient;
        ctx.fillRect(0,0,WIDTH,HEIGHT);
        // Dalgalı lav efekt
        for(let i=0;i<50;i++){
            ctx.beginPath();
            ctx.arc(Math.random()*WIDTH, Math.random()*HEIGHT, Math.random()*50+20, 0, Math.PI*2);
            ctx.fillStyle = `rgba(255,${Math.floor(Math.random()*150)},0,0.1)`;
            ctx.fill();
        }
    } else {
        ctx.fillStyle = '#0d0d0d';
        ctx.fillRect(0,0,WIDTH,HEIGHT);
    }
}

// Bot zorluğu
function updateBotDifficulty(){
    if(leftScore>=160){ botSpeed=30; botError=0; }
    else if(leftScore>=80){ botSpeed=20; botError=0.01; }
    else if(leftScore>=45){ botSpeed=15; botError=0.02; }
    else if(leftScore>=15){ botSpeed=10; botError=0.1; }
    else{ botSpeed=6; botError=0.3; }
}

// Fire particle sistemi
function addFire(x,y){
    for(let i=0;i<20;i++){
        fireParticles.push({
            x:x,
            y:y,
            vx:(Math.random()-0.5)*12,
            vy:(Math.random()-3)*12,
            life: Math.random()*30+20,
            color:`rgb(${200+Math.random()*55},${50+Math.random()*50},0)`
        });
    }
}

function drawFire(){
    for(let i=fireParticles.length-1;i>=0;i--){
        let p=fireParticles[i];
        ctx.globalAlpha=p.life/50;
        ctx.fillStyle=p.color;
        ctx.beginPath();
        ctx.arc(p.x,p.y,Math.min(ballRadius/2,5),0,Math.PI*2);
        ctx.fill();
        ctx.globalAlpha=1;
        p.x+=p.vx;
        p.y+=p.vy;
        p.life--;
        if(p.life<=0) fireParticles.splice(i,1);
    }
}

// Oyun döngüsü
function gameLoop(){
    colorOffset+=0.02; 

    // Klavye sol raket
    if(keys['w'] && leftPaddleY>0) leftPaddleY-=paddleSpeed;
    if(keys['s'] && leftPaddleY+paddleHeight<HEIGHT) leftPaddleY+=paddleSpeed;

    updateBotDifficulty();

    // Bot sağ raket
    let targetY=ballY-paddleHeight/2;
    let randomness=0;
    if(leftScore<15) randomness=5;
    else if(leftScore<45) randomness=3;
    else if(leftScore<80) randomness=1;
    else if(leftScore<160) randomness=0.5;
    else randomness=0;
    let move=(targetY-(rightPaddleY+paddleHeight/2))+(Math.random()*randomness-randomness/2);
    if(move>botError) rightPaddleY+=Math.min(botSpeed,move);
    else if(move<-botError) rightPaddleY-=Math.min(botSpeed,-move);
    if(rightPaddleY<0) rightPaddleY=0;
    if(rightPaddleY+paddleHeight>HEIGHT) rightPaddleY=HEIGHT-paddleHeight;

    // Top hareketi
    if(leftScore>=160){
        ballSpeedX *= 1.0003 + Math.random()*0.003;
        ballSpeedY *= 1.0003 + Math.random()*0.003;
    } else {
        ballSpeedX *= 1.00005; 
        ballSpeedY *= 1.00005;
    }
    ballX+=ballSpeedX; 
    ballY+=ballSpeedY;

    // Duvar
    if(ballY-ballRadius<=0 || ballY+ballRadius>=HEIGHT) {
        ballSpeedY*=-1;
        if(leftScore>=160) addFire(ballX,ballY);
        if(leftScore>=160) screenShake = 10;
    }

    // Raket çarpması ve açı
    function bounce(paddleY,isLeft){
        let collide=(ballY-(paddleY+paddleHeight/2))/(paddleHeight/2);
        let angle=Math.PI/4*collide;
        let speed=Math.sqrt(ballSpeedX*ballSpeedX+ballSpeedY*ballSpeedY);
        ballSpeedY=speed*Math.sin(angle);
        ballSpeedX=(isLeft?1:-1)*Math.abs(speed*Math.cos(angle));
    }
    if(ballX-ballRadius<=50+paddleWidth && ballY>=leftPaddleY && ballY<=leftPaddleY+paddleHeight){
        bounce(leftPaddleY,true); ballX=50+paddleWidth+ballRadius; hitFlash=5;
        trails.push({x:ballX, y:ballY, life:20, color: rainbowColorSlow(0)});
        if(leftScore>=160) { addFire(ballX,ballY); screenShake=10; }
    }
    if(ballX+ballRadius>=WIDTH-50-paddleWidth && ballY>=rightPaddleY && ballY<=rightPaddleY+paddleHeight){
        bounce(rightPaddleY,false); ballX=WIDTH-50-paddleWidth-ballRadius; hitFlash=5;
        trails.push({x:ballX, y:ballY, life:20, color: rainbowColorSlow(10)});
        if(leftScore>=160) { addFire(ballX,ballY); screenShake=10; }
    }

    // Skor
    if(ballX-ballRadius<=0){ rightScore++; resetBall(); hitFlash=5; if(leftScore>=160) addFire(ballX,ballY); if(leftScore>=160) screenShake=10;}
    if(ballX+ballRadius>=WIDTH){ leftScore++; resetBall(); hitFlash=5; if(leftScore>=160) addFire(ballX,ballY); if(leftScore>=160) screenShake=10;}

    // Ekran titremesi
    let shakeX=0, shakeY=0;
    if(screenShake>0){ 
        shakeX=(Math.random()-0.5)*screenShake; 
        shakeY=(Math.random()-0.5)*screenShake; 
        screenShake--;
    }
    ctx.save();
    ctx.translate(shakeX, shakeY);

    drawBackground();

    // Raketler
    ctx.fillStyle=rainbowColorSlow(0); ctx.fillRect(50,leftPaddleY,paddleWidth,paddleHeight);
    ctx.fillStyle=rainbowColorSlow(10); ctx.fillRect(WIDTH-50-paddleWidth,rightPaddleY,paddleWidth,paddleHeight);

    // Top izleri
    for(let i=trails.length-1;i>=0;i--){
        let t=trails[i];
        ctx.fillStyle=t.color;
        ctx.globalAlpha=t.life/20*0.4;
        ctx.beginPath(); ctx.arc(t.x,t.y,ballRadius/2,0,Math.PI*2); ctx.fill();
        ctx.globalAlpha=1;
        t.life--;
        if(t.life<=0) trails.splice(i,1);
    }

    // Top glow
    ctx.shadowBlur=30; ctx.shadowColor=rainbowColorSlow(5);
    ctx.beginPath(); ctx.arc(ballX,ballY,ballRadius,0,Math.PI*2); ctx.fillStyle=rainbowColorSlow(5); ctx.fill();
    ctx.shadowBlur=0;

    // Fire particle
    if(leftScore>=160) drawFire();

    // Hit flash
    if(hitFlash>0){ ctx.fillStyle='rgba(255,255,255,0.1)'; ctx.fillRect(0,0,WIDTH,HEIGHT); hitFlash--; }

    ctx.restore();

    // Skor ve isim
    ctx.fillStyle='white'; ctx.font=`${Math.floor(HEIGHT*0.07)}px Arial`;
    ctx.fillText(leftScore,WIDTH/4-20,Math.floor(HEIGHT*0.1));
    ctx.fillText(rightScore,3*WIDTH/4-20,Math.floor(HEIGHT*0.1));
    ctx.font=`${Math.floor(HEIGHT*0.04)}px Arial`; ctx.fillStyle='white';
    ctx.fillText('Asaf Battal',WIDTH/2-80,HEIGHT/2-20);

    // Bot seviyesi
    ctx.font=`${Math.floor(HEIGHT*0.03)}px Arial`; ctx.fillStyle='white';
    let level='';
    if(leftScore>=160) level='İmkansız';
    else if(leftScore>=80) level='Çok Zor';
    else if(leftScore>=45) level='Zor';
    else if(leftScore>=15) level='Orta';
    else level='Kolay';
    ctx.fillText('Bot Seviyesi: '+level,WIDTH/2-100,50);

    requestAnimationFrame(gameLoop);
}

function resetBall(){ 
    ballX=WIDTH/2; 
    ballY=HEIGHT/2; 
    ballSpeedX=Math.max(12, WIDTH*0.01); 
    ballSpeedY=Math.max(12, HEIGHT*0.01); 
}
window.addEventListener('resize',()=>{
    WIDTH=window.innerWidth; HEIGHT=window.innerHeight; canvas.width=WIDTH; canvas.height=HEIGHT; 
    ballRadius=Math.min(WIDTH, HEIGHT) * 0.03;
    paddleWidth=Math.min(WIDTH, HEIGHT)*0.03;
    paddleHeight=Math.min(WIDTH, HEIGHT)*0.25;
    paddleSpeed=Math.max(20, HEIGHT*0.02);
    leftPaddleY = HEIGHT/2 - paddleHeight/2;
    rightPaddleY = HEIGHT/2 - paddleHeight/2;
});

gameLoop();
</script>
</body>
</html>
